<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Targeted Manipulation: Slope-Based Attacks on Financial Time-Series Data | Research Agent Knowledge Base</title>
<meta name="keywords" content="Adversarial Attacks (적대적 공격), Financial Time-Series (금융 시계열), N-HiTS, Targeted Manipulation (표적 조작), ML Security Pipeline (ML 보안 파이프라인)">
<meta name="description" content="Abstract A common method of attacking deep learning models is through adversarial attacks, which occur when an attacker specifically modifies the input of a model to produce an incorrect result. Adversarial attacks have been deeply investigated in the image domain; however, there is less research in the time-series domain and very little for forecasting financial data. To address these concerns, this study aims to build upon previous research on adversarial attacks for time-series data by introducing two new slope-based methods aimed to alter the trends of the predicted stock forecast generated by an N-HiTS model.">
<meta name="author" content="">
<link rel="canonical" href="https://hanwo-ol.github.io/Unet_master/posts/targeted-manipulation-slope-based-attacks-on-financial-time-series-data/">
<link crossorigin="anonymous" href="/Unet_master/assets/css/stylesheet.62aa25427797f8efd87301a5b69795dc50df2dbe79a5fba0648cc7bb8dbcd7c9.css" integrity="sha256-YqolQneX&#43;O/YcwGltpeV3FDfLb55pfugZIzHu42818k=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/Unet_master/assets/js/highlight.acb54fd32bbc1982428b8850317e45d076b95012730a5936667e6bc21777692a.js" integrity="sha256-rLVP0yu8GYJCi4hQMX5F0Ha5UBJzClk2Zn5rwhd3aSo="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://hanwo-ol.github.io/Unet_master/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://hanwo-ol.github.io/Unet_master/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://hanwo-ol.github.io/Unet_master/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://hanwo-ol.github.io/Unet_master/apple-touch-icon.png">
<link rel="mask-icon" href="https://hanwo-ol.github.io/Unet_master/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasYbI1F/F" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYwHR5IXS0n1q35dx72xvRIe8+y/k6PrmJeCA1pNEk1e" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>

<meta property="og:title" content="Targeted Manipulation: Slope-Based Attacks on Financial Time-Series Data" />
<meta property="og:description" content="Abstract A common method of attacking deep learning models is through adversarial attacks, which occur when an attacker specifically modifies the input of a model to produce an incorrect result. Adversarial attacks have been deeply investigated in the image domain; however, there is less research in the time-series domain and very little for forecasting financial data. To address these concerns, this study aims to build upon previous research on adversarial attacks for time-series data by introducing two new slope-based methods aimed to alter the trends of the predicted stock forecast generated by an N-HiTS model." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://hanwo-ol.github.io/Unet_master/posts/targeted-manipulation-slope-based-attacks-on-financial-time-series-data/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2025-11-24T00:00:00+00:00" />
<meta property="article:modified_time" content="2025-11-24T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Targeted Manipulation: Slope-Based Attacks on Financial Time-Series Data"/>
<meta name="twitter:description" content="Abstract A common method of attacking deep learning models is through adversarial attacks, which occur when an attacker specifically modifies the input of a model to produce an incorrect result. Adversarial attacks have been deeply investigated in the image domain; however, there is less research in the time-series domain and very little for forecasting financial data. To address these concerns, this study aims to build upon previous research on adversarial attacks for time-series data by introducing two new slope-based methods aimed to alter the trends of the predicted stock forecast generated by an N-HiTS model."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://hanwo-ol.github.io/Unet_master/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Targeted Manipulation: Slope-Based Attacks on Financial Time-Series Data",
      "item": "https://hanwo-ol.github.io/Unet_master/posts/targeted-manipulation-slope-based-attacks-on-financial-time-series-data/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Targeted Manipulation: Slope-Based Attacks on Financial Time-Series Data",
  "name": "Targeted Manipulation: Slope-Based Attacks on Financial Time-Series Data",
  "description": "Abstract A common method of attacking deep learning models is through adversarial attacks, which occur when an attacker specifically modifies the input of a model to produce an incorrect result. Adversarial attacks have been deeply investigated in the image domain; however, there is less research in the time-series domain and very little for forecasting financial data. To address these concerns, this study aims to build upon previous research on adversarial attacks for time-series data by introducing two new slope-based methods aimed to alter the trends of the predicted stock forecast generated by an N-HiTS model.",
  "keywords": [
    "Adversarial Attacks (적대적 공격)", "Financial Time-Series (금융 시계열)", "N-HiTS", "Targeted Manipulation (표적 조작)", "ML Security Pipeline (ML 보안 파이프라인)"
  ],
  "articleBody": "Abstract A common method of attacking deep learning models is through adversarial attacks, which occur when an attacker specifically modifies the input of a model to produce an incorrect result. Adversarial attacks have been deeply investigated in the image domain; however, there is less research in the time-series domain and very little for forecasting financial data. To address these concerns, this study aims to build upon previous research on adversarial attacks for time-series data by introducing two new slope-based methods aimed to alter the trends of the predicted stock forecast generated by an N-HiTS model. Compared to the normal N-HiTS predictions, the two new slope-based methods, the General Slope Attack and Least-Squares Slope Attack, can manipulate N-HiTS predictions by doubling the slope. These new slope attacks can bypass standard security mechanisms, such as a discriminator that filters real and perturbed inputs, reducing a 4-layered CNN’s specificity to 28% and accuracy to 57%. Furthermore, the slope based methods were incorporated into a GAN architecture as a means of generating realistic synthetic data, while simultaneously fooling the model. Finally, this paper also proposes a sample malware designed to inject an adversarial attack in the model inference library, proving that ML-security research should not only focus on making the model safe, but also securing the entire pipeline.\nPDF Download Local PDF View | Arxiv Original\n본 논문 “Targeted Manipulation: Slope-Based Attacks on Financial Time-Series Data\"에 대한 상세 한국어 리포트입니다.\n1. 요약 (Executive Summary) 본 연구는 금융 시계열 데이터 예측 모델에 대한 표적형 적대적 공격(Targeted Adversarial Attacks)의 새로운 방법론을 제시하고, 전체 머신러닝(ML) 파이프라인의 보안 취약성을 탐구합니다.\n새로운 공격 방법론: 예측된 주가 추세(Slope)를 조작하는 두 가지 새로운 기울기 기반 공격(Slope-Based Attacks)인 **General Slope Attack (GSA)**과 **Least-Squares Slope Attack (LSSA)**을 도입했습니다. 표적 모델: 기존 연구와 달리, 300개 이상의 S\u0026P 500 주식 데이터로 훈련된 최신 시계열 예측 모델인 N-HiTS를 표적으로 삼았습니다. 공격 효과: GSA와 LSSA는 N-HiTS 예측의 기울기를 두 배로 증가시키거나 원하는 방향으로 급격히 변경할 수 있음을 입증했습니다. 은밀성 (Stealthiness): 이 새로운 기울기 기반 공격들은 4계층 CNN 판별기(Discriminator)와 같은 표준 보안 메커니즘을 우회할 수 있으며, 판별기의 특이도(Specificity)를 28%, 정확도(Accuracy)를 57%까지 낮춥니다. 현실적인 데이터 생성: 기울기 기반 공격 방법론을 GAN (Generative Adversarial Network) 아키텍처에 통합하여 모델을 속이는 동시에 현실적인 합성(Synthetic) 데이터를 생성하는 **Adversarial GAN (A-GAN)**을 구축했습니다. ML 보안 파이프라인 취약성: 모델 추론 라이브러리(Model Inference Library)에 적대적 공격을 주입하도록 설계된 샘플 악성코드(Malware)를 제안하여, ML 보안 연구가 모델 자체뿐만 아니라 전체 파이프라인을 보호하는 데 집중해야 함을 강조했습니다. 2. 7가지 핵심 질문 분석 (Key Analysis) 1) What is new in the work? (기존 연구와의 차별점) 본 연구는 금융 시계열 데이터에 특화된 두 가지 새로운 기울기 기반 표적 공격(GSA 및 LSSA)을 도입했습니다. 기존의 표적 공격(예: TIM)은 단순히 예측값을 스칼라 마진만큼 이동시키거나 비현실적인 목표 시퀀스($Y^*$)를 설정하는 데 그쳤지만, GSA와 LSSA는 예측의 시간적 특성(Temporal Characteristics), 즉 추세(기울기)를 직접 조작하도록 손실 함수에 내장했습니다. 또한, 기존 연구가 단순한 CNN 모델을 표적으로 삼았던 것과 달리, 본 연구는 300개 이상의 주식 데이터로 훈련되어 견고성이 높은 최신 N-HiTS 예측 모델을 성공적으로 공격했습니다. 마지막으로, 이 공격을 GAN에 통합하여 현실적인 적대적 데이터를 생성하는 A-GAN 아키텍처를 제안하고, ML 파이프라인에 악성코드를 주입하는 위협 모델을 제시하여 보안 연구의 범위를 확장했습니다.\n2) Why is the work important? (연구의 중요성) 금융 및 헬스케어와 같은 고위험 부문에서 ML/AI 모델의 사용이 증가함에 따라, 이러한 예측 모델의 견고성은 필수적입니다. 본 연구는 최신 예측 모델인 N-HiTS조차도 표적 공격에 매우 취약함을 입증합니다. 특히, 예측의 추세를 조작하는 능력은 공격자가 시장에 영향을 미치거나 피해자에게 특정 행동(예: 주식 매수/매도)을 유도하는 데 실질적인 이점을 제공합니다. 또한, 제안된 공격이 표준 방어 메커니즘(판별기)을 우회할 수 있다는 점과, 모델 배포 후 추론 단계에서 악성코드를 통해 공격이 주입될 수 있다는 점을 보여줌으로써, ML 시스템의 전체 보안 파이프라인을 확보하는 것의 중요성을 강조합니다.\n3) What is the literature gap? (기존 연구의 한계점) 적대적 공격 연구는 이미지 도메인에 집중되어 있으며, 시계열 데이터, 특히 금융 예측 데이터에 대한 연구는 초기 단계에 머물러 있었습니다. 기존 시계열 공격의 주요 한계점은 다음과 같습니다. 첫째, 시계열 데이터에 가해지는 섭동(Perturbation)은 이미지에 비해 눈에 띄기 쉬워 현실성(Believability)을 확보하기 어려웠습니다. 둘째, 기존의 표적 공격은 예측의 전반적인 추세를 변경하지 못하고 단순히 예측값을 위아래로 이동시키는 데 그쳤습니다. 셋째, 기존 공격 연구는 비교적 단순한 모델 아키텍처(예: 얕은 CNN)를 대상으로 했습니다.\n4) How is the gap filled? (해결 방안) 본 연구는 원하는 기울기(추세)를 손실 함수 내부에 직접 내장하는 GSA와 LSSA를 개발하여 예측의 시간적 특성을 효과적으로 변경합니다. GSA는 예측의 끝점만을 사용하여 기울기를 계산함으로써 공격의 은밀성을 높였고, LSSA는 최소 제곱 선형 회귀(Least-Squares Linear Regression)의 기울기를 사용하여 예측의 전반적인 추세를 조작합니다. 또한, 이 기울기 기반 목표를 Conditional WGAN에 통합한 A-GAN을 사용하여, 현실적이고 탐지하기 어려운 합성 적대적 데이터를 대량으로 생성함으로써 현실성 문제를 해결했습니다. 마지막으로, N-HiTS와 같은 최신 모델을 표적으로 삼아 공격의 적용 가능성을 높였습니다.\n5) What is achieved with the new method? (달성한 성과) [Table 1 분석: 평균 공격 지표 (Average Metrics)]\n$\\epsilon = 2%$ (중앙값 주가의 2% 섭동) 조건에서, 제안된 기울기 기반 공격은 기존 공격 대비 목표 달성 측면에서 우수했습니다.\nAttack MAE RMSE Gen. Slope (Normal: $3.37 \\times 10^{-2}$) LS Slope (Normal: $2.22 \\times 10^{-2}$) Normal 2.15 2.72 $3.37 \\times 10^{-2}$ $2.22 \\times 10^{-2}$ BIM 3.38 3.99 $3.48 \\times 10^{-2}$ $2.39 \\times 10^{-2}$ GSA (Up) 2.26 2.88 $6.76 \\times 10^{-2}$ $2.77 \\times 10^{-2}$ GSA (Down) 2.23 2.83 $-1.68 \\times 10^{-4}$ $1.75 \\times 10^{-2}$ LSSA (Up) 2.49 3.10 $5.38 \\times 10^{-2}$ $4.96 \\times 10^{-2}$ LSSA (Down) 2.71 3.33 $1.56 \\times 10^{-2}$ $-5.04 \\times 10^{-3}$ 기울기 조작 성공: GSA (Up)는 일반 기울기(Gen. Slope)를 $6.76 \\times 10^{-2}$로, 정상 예측($3.37 \\times 10^{-2}$)의 약 두 배로 증가시켰습니다. LSSA (Up)는 최소 제곱 기울기(LS Slope)를 $4.96 \\times 10^{-2}$로, 정상 예측($2.22 \\times 10^{-2}$)의 두 배 이상으로 증가시켰습니다. 하향 조작 성공: GSA (Down)는 일반 기울기를 거의 0에 가깝게($-1.68 \\times 10^{-4}$) 만들었고, LSSA (Down)는 LS 기울기를 음수($-5.04 \\times 10^{-3}$)로 만들어 하향 추세를 성공적으로 조작했습니다. 은밀성 입증 (Figure 6): 4계층 CNN 판별기는 GSA 공격에 대해 52.08%의 정확도와 27.78%의 특이도를, LSSA 공격에 대해 56.25%의 정확도와 26.40%의 특이도를 보였습니다. 이는 공격이 표준 방어 메커니즘을 효과적으로 우회함을 의미합니다. A-GAN의 현실성 (Table 3): A-GAN은 실제 데이터의 LS Slope ($-2.41 \\times 10^{-3}$)를 목표값인 $2.17 \\times 10^{-1}$로 성공적으로 이동시키면서도, 통계적 지표(Table 4의 MMD: $1.20 \\times 10^{-4}$)는 매우 낮아 합성 데이터가 실제 데이터와 충실하게 유사함을 입증했습니다. 6) What data are used? (사용 데이터셋) 데이터셋: CRSP(Center for Research Security Prices)에서 수집된 모든 S\u0026P 500 주식의 일일 조정 가격(adjprc). 기간: 2015년 5월 1일 ~ 2025년 5월 1일. 특징: 금융 시계열 데이터로, 높은 변동성과 노이즈에 민감한 도메인 특성을 가집니다. 전처리 및 특징 공학: 롤링 평균 및 표준 편차 (윈도우 크기 5, 10, 20). 로그 수익률 (Log Returns). 변화율 (Rate of Change, $\\Delta=5$). 지수 이동 평균 (Exponential Moving Averages, 윈도우 크기 5, 10, 20). 요일 (범주형 특징). 데이터 분할: 600일 미만 기록은 제외되었으며, 훈련 75% (360개 기록), 검증 10% (48개), 테스트 15% (72개)로 계층적 분할(Stratified Split)을 사용했습니다. 7) What are the limitations? (저자가 언급한 한계점) 일반성 부족: 공격 방법론의 일반적인 효과를 입증하기 위해 CNN이나 LSTM과 같은 다른 ML 모델을 피해 모델로 사용한 추가 연구가 필요합니다. 방어 전략 부재: N-HiTS 모델의 구조적 제약(adjprc를 특징으로 사용하고 롤링 윈도우로 예측) 때문에 표준 방어 전략인 적대적 훈련(Adversarial Training)을 수행하는 것이 비실용적이었습니다. A-GAN의 불안정성: A-GAN은 모드 붕괴(Mode Collapse) 현상을 겪어 생성된 데이터의 다양성이 제한적이며, 이로 인해 합성 데이터가 판별기에 의해 쉽게 식별될 수 있습니다 (반면, 반복 공격 자체는 은밀함). A-GAN의 훈련 안정성과 성능 개선이 필요합니다. 도메인 확장 필요: 기울기 기반 공격의 적용 가능성을 입증하기 위해 교통량이나 전력 사용량과 같은 다른 시계열 도메인에 대한 구현이 필요합니다. 3. 아키텍처 및 방법론 (Architecture \u0026 Methodology) Figure 분석: Targeted Adversarial GAN (A-GAN) 아키텍처 (Figure 1) Figure 1은 제안된 표적형 적대적 GAN (A-GAN)의 고수준 아키텍처 다이어그램입니다. 이 구조는 기존의 GAN에 피해 모델인 N-HiTS를 두 번째 판별자(Critic)로 추가하여 표적 공격 목표를 통합한 형태입니다.\nGenerator (생성자):\n입력: Time Series Data (조건), Target Direction (목표 기울기 방향), Noise (잡음). 역할: 실제 데이터와 유사하면서도 N-HiTS 모델을 속일 수 있는 합성 적대적 시계열 데이터($\\tilde{\\mathbf{x}}$)를 생성합니다. 구조: 4계층 TCN (Temporal Convolutional Network)을 사용하여 장기 의존성(Long Term Dependencies)을 포착합니다. Discriminator/Critic (판별자/비평가):\n입력: 실제 시계열 데이터($\\mathbf{x}$) 또는 생성된 적대적 시계열 데이터($\\tilde{\\mathbf{x}}$). 역할: 입력이 “Real or Fake?“인지 판별하여 생성자가 현실적인 데이터를 만들도록 유도합니다. 구조: TCN 블록 3개와 GRU 블록 2개가 교대로 구성된 하이브리드 아키텍처를 사용합니다. N-HiTS Model (피해 모델/두 번째 Critic):\n입력: 생성자가 만든 적대적 시계열 데이터($\\tilde{\\mathbf{x}}$). 역할: 예측을 수행하고, 이 예측의 기울기가 목표 방향(“Correct Slope?\")과 일치하는지 확인하는 손실($\\text{LSSA}(N\\text{-HiTS}(\\tilde{\\mathbf{x}}))$)을 계산합니다. 이 손실은 생성자의 목적 함수에 통합되어 기울기 조작을 유도합니다. 흐름: 생성자는 판별자를 속여 현실성을 확보하는 동시에, N-HiTS 모델을 속여 예측의 기울기를 원하는 방향으로 조작하는 이중 목표를 달성하도록 훈련됩니다.\n수식 상세 1. 기울기 계산 수식 General Slope Attack (GSA) 기울기 ($m$): 예측의 끝점 $(x_1, y_1)$과 $(x_2, y_2)$ 사이의 이산적인 기울기입니다. $$m = \\frac{y_2 - y_1}{x_2 - x_1}$$\nLeast-Squares Slope Attack (LSSA) 기울기 ($m$): 최소 제곱 선형 회귀의 폐쇄형 해(Closed-form Solution)에서 가중치 항(기울기)을 사용합니다. $N$은 예측 길이, $\\bar{x}$와 $\\bar{y}$는 각각 $x$와 $y$의 평균입니다. $$m = \\frac{\\sum_{i=0}^{N} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=0}^{N} (x_i - \\bar{x})^2}$$\n2. 기울기 공격 손실 함수 (Loss Function) GSA와 LSSA 모두 동일한 손실 함수 구조를 사용하며, $m$은 위에서 계산된 기울기입니다. $t \\in {-1, 0, 1}$은 목표 방향입니다. $$\\text{loss} = \\begin{cases} c e^{-tdm} \u0026 \\text{if } t \\in {-1, 1} \\ c m^2 \u0026 \\text{if } t = 0 \\end{cases} \\quad (1)$$\n$t=1$ (상승 목표): $m$이 작거나 음수일 때 손실이 커집니다. $t=-1$ (하락 목표): $m$이 크거나 양수일 때 손실이 커집니다. $t=0$ (제로 기울기 목표): 기울기 $m$의 제곱에 비례하여 손실이 커집니다. 3. Adversarial GAN (A-GAN) 손실 함수 본 연구는 Conditional Wasserstein GAN (C-WGAN)에 Gradient Penalty (GP)를 추가한 구조를 사용합니다.\nA-GAN Generator Loss ($L_g$): 생성자는 판별자를 속이는 목표와 N-HiTS 모델을 속이는 목표를 동시에 가집니다. $$L_g = \\mathbb{E}{\\mathbf{x} \\sim p{\\mathbf{x}}} [D(\\mathbf{x})] + \\alpha \\cdot \\text{LSSA}(N\\text{-HiTS}(\\mathbf{x}))$$\n$\\mathbb{E}{\\mathbf{x} \\sim p{\\mathbf{x}}} [D(\\mathbf{x})]$: 판별자가 생성된 데이터를 실제라고 판단하도록 유도하는 항 (WGAN Critic Loss). $\\alpha$: 적대적 손실의 균형을 맞추는 스케일링 인자. $\\text{LSSA}(N\\text{-HiTS}(\\mathbf{x}))$: N-HiTS 예측에 대한 LSSA 손실 (기울기 조작 목표). A-GAN Final Loss ($L$): WGAN-GP 형태의 최종 손실 함수입니다. $\\tilde{\\mathbf{x}}$는 합성 샘플, $\\hat{\\mathbf{x}}$는 실제와 합성 샘플 사이의 보간된 샘플입니다. $$L = L_g - \\mathbb{E}{\\tilde{\\mathbf{x}} \\sim p_g} [D(\\tilde{\\mathbf{x}})] + \\lambda \\cdot \\mathbb{E}{\\hat{\\mathbf{x}} \\sim p_{\\hat{\\mathbf{x}}}} [(|\\nabla_{\\hat{\\mathbf{x}}} D(\\hat{\\mathbf{x}})| - 1)^2]$$\n$\\lambda$: 기울기 페널티의 크기를 제어하는 상수. Vanilla U-Net 비교 (N-HiTS 아키텍처 분석) 본 논문은 U-Net이 아닌 N-HiTS 모델을 피해 모델로 사용합니다. N-HiTS는 N-BEATS 아키텍처를 기반으로 구축되었으며, 계산 성능과 정확도를 동시에 개선하기 위해 다음과 같은 핵심 모듈을 추가/수정했습니다.\n구분 Vanilla N-BEATS N-HiTS (Neural Hierarchical Interpolation for Time Series) 기본 구조 MLP(Multi-layer Perceptron)를 사용하여 Backcast 및 Forecast 계수 추정. MLP를 사용하여 Backcast 및 Forecast 계수 추정. 핵심 추가 모듈 없음 MaxPool 레이어 추가: 각 블록 $b$에 커널 크기 $k_t$를 가진 MaxPool을 도입. 목적 시계열의 장기/단기 콘텐츠를 분리하여 예측. MaxPool을 통해 MLP가 시계열의 저주파 및 대규모 콘텐츠에 집중하도록 유도하여 서로 다른 속도로 시계열을 샘플링할 수 있게 함. 최종 예측 모든 블록의 Forecast를 합산. 계층적 보간(Hierarchical Interpolation) 수행. 각 예측 스택에 표현력 비율(Expressiveness Ratio)을 할당하고, 이 비율의 크기에 따라 예측 스택을 합산하여 최종 예측을 생성. 4. 태그 제안 (Tags Suggestion) Adversarial Attacks (적대적 공격) Financial Time-Series (금융 시계열) N-HiTS Targeted Manipulation (표적 조작) ML Security Pipeline (ML 보안 파이프라인) ",
  "wordCount" : "1756",
  "inLanguage": "en",
  "datePublished": "2025-11-24T00:00:00Z",
  "dateModified": "2025-11-24T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://hanwo-ol.github.io/Unet_master/posts/targeted-manipulation-slope-based-attacks-on-financial-time-series-data/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Research Agent Knowledge Base",
    "logo": {
      "@type": "ImageObject",
      "url": "https://hanwo-ol.github.io/Unet_master/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://hanwo-ol.github.io/Unet_master/" accesskey="h" title="Research Agent Knowledge Base (Alt + H)">Research Agent Knowledge Base</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://hanwo-ol.github.io/Unet_master/categories/" title="categories">
                    <span>categories</span>
                </a>
            </li>
            <li>
                <a href="https://hanwo-ol.github.io/Unet_master/tags/" title="tags">
                    <span>tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://hanwo-ol.github.io/Unet_master/">Home</a>&nbsp;»&nbsp;<a href="https://hanwo-ol.github.io/Unet_master/posts/">Posts</a></div>
    <h1 class="post-title">
      Targeted Manipulation: Slope-Based Attacks on Financial Time-Series Data
    </h1>
    <div class="post-meta">&lt;span title=&#39;2025-11-24 00:00:00 &#43;0000 UTC&#39;&gt;November 24, 2025&lt;/span&gt;&amp;nbsp;·&amp;nbsp;9 min

</div>
  </header> 
  <div class="post-content"><h2 id="abstract">Abstract<a hidden class="anchor" aria-hidden="true" href="#abstract">#</a></h2>
<p>A common method of attacking deep learning models is through adversarial attacks, which occur when an attacker specifically modifies the input of a model to produce an incorrect result. Adversarial attacks have been deeply investigated in the image domain; however, there is less research in the time-series domain and very little for forecasting financial data. To address these concerns, this study aims to build upon previous research on adversarial attacks for time-series data by introducing two new slope-based methods aimed to alter the trends of the predicted stock forecast generated by an N-HiTS model. Compared to the normal N-HiTS predictions, the two new slope-based methods, the General Slope Attack and Least-Squares Slope Attack, can manipulate N-HiTS predictions by doubling the slope. These new slope attacks can bypass standard security mechanisms, such as a discriminator that filters real and perturbed inputs, reducing a 4-layered CNN&rsquo;s specificity to 28% and accuracy to 57%. Furthermore, the slope based methods were incorporated into a GAN architecture as a means of generating realistic synthetic data, while simultaneously fooling the model. Finally, this paper also proposes a sample malware designed to inject an adversarial attack in the model inference library, proving that ML-security research should not only focus on making the model safe, but also securing the entire pipeline.</p>
<h2 id="pdf-download">PDF Download<a hidden class="anchor" aria-hidden="true" href="#pdf-download">#</a></h2>
<p><a href="//172.22.138.185/Research_pdf/2511.19330v1.pdf">Local PDF View</a> | <a href="http://arxiv.org/abs/2511.19330v1">Arxiv Original</a></p>
<p>본 논문 &ldquo;Targeted Manipulation: Slope-Based Attacks on Financial Time-Series Data&quot;에 대한 상세 한국어 리포트입니다.</p>
<hr>
<h2 id="1-요약-executive-summary">1. 요약 (Executive Summary)<a hidden class="anchor" aria-hidden="true" href="#1-요약-executive-summary">#</a></h2>
<p>본 연구는 금융 시계열 데이터 예측 모델에 대한 표적형 적대적 공격(Targeted Adversarial Attacks)의 새로운 방법론을 제시하고, 전체 머신러닝(ML) 파이프라인의 보안 취약성을 탐구합니다.</p>
<ul>
<li><strong>새로운 공격 방법론:</strong> 예측된 주가 추세(Slope)를 조작하는 두 가지 새로운 기울기 기반 공격(Slope-Based Attacks)인 **General Slope Attack (GSA)**과 **Least-Squares Slope Attack (LSSA)**을 도입했습니다.</li>
<li><strong>표적 모델:</strong> 기존 연구와 달리, 300개 이상의 S&amp;P 500 주식 데이터로 훈련된 최신 시계열 예측 모델인 <strong>N-HiTS</strong>를 표적으로 삼았습니다.</li>
<li><strong>공격 효과:</strong> GSA와 LSSA는 N-HiTS 예측의 기울기를 두 배로 증가시키거나 원하는 방향으로 급격히 변경할 수 있음을 입증했습니다.</li>
<li><strong>은밀성 (Stealthiness):</strong> 이 새로운 기울기 기반 공격들은 4계층 CNN 판별기(Discriminator)와 같은 표준 보안 메커니즘을 우회할 수 있으며, 판별기의 특이도(Specificity)를 28%, 정확도(Accuracy)를 57%까지 낮춥니다.</li>
<li><strong>현실적인 데이터 생성:</strong> 기울기 기반 공격 방법론을 <strong>GAN (Generative Adversarial Network)</strong> 아키텍처에 통합하여 모델을 속이는 동시에 현실적인 합성(Synthetic) 데이터를 생성하는 **Adversarial GAN (A-GAN)**을 구축했습니다.</li>
<li><strong>ML 보안 파이프라인 취약성:</strong> 모델 추론 라이브러리(Model Inference Library)에 적대적 공격을 주입하도록 설계된 샘플 악성코드(Malware)를 제안하여, ML 보안 연구가 모델 자체뿐만 아니라 전체 파이프라인을 보호하는 데 집중해야 함을 강조했습니다.</li>
</ul>
<hr>
<h2 id="2-7가지-핵심-질문-분석-key-analysis">2. 7가지 핵심 질문 분석 (Key Analysis)<a hidden class="anchor" aria-hidden="true" href="#2-7가지-핵심-질문-분석-key-analysis">#</a></h2>
<h3 id="1-what-is-new-in-the-work-기존-연구와의-차별점">1) What is new in the work? (기존 연구와의 차별점)<a hidden class="anchor" aria-hidden="true" href="#1-what-is-new-in-the-work-기존-연구와의-차별점">#</a></h3>
<p>본 연구는 금융 시계열 데이터에 특화된 두 가지 새로운 기울기 기반 표적 공격(GSA 및 LSSA)을 도입했습니다. 기존의 표적 공격(예: TIM)은 단순히 예측값을 스칼라 마진만큼 이동시키거나 비현실적인 목표 시퀀스($Y^*$)를 설정하는 데 그쳤지만, GSA와 LSSA는 예측의 <strong>시간적 특성(Temporal Characteristics)</strong>, 즉 추세(기울기)를 직접 조작하도록 손실 함수에 내장했습니다. 또한, 기존 연구가 단순한 CNN 모델을 표적으로 삼았던 것과 달리, 본 연구는 300개 이상의 주식 데이터로 훈련되어 견고성이 높은 최신 N-HiTS 예측 모델을 성공적으로 공격했습니다. 마지막으로, 이 공격을 GAN에 통합하여 현실적인 적대적 데이터를 생성하는 A-GAN 아키텍처를 제안하고, ML 파이프라인에 악성코드를 주입하는 위협 모델을 제시하여 보안 연구의 범위를 확장했습니다.</p>
<h3 id="2-why-is-the-work-important-연구의-중요성">2) Why is the work important? (연구의 중요성)<a hidden class="anchor" aria-hidden="true" href="#2-why-is-the-work-important-연구의-중요성">#</a></h3>
<p>금융 및 헬스케어와 같은 고위험 부문에서 ML/AI 모델의 사용이 증가함에 따라, 이러한 예측 모델의 견고성은 필수적입니다. 본 연구는 최신 예측 모델인 N-HiTS조차도 표적 공격에 매우 취약함을 입증합니다. 특히, 예측의 추세를 조작하는 능력은 공격자가 시장에 영향을 미치거나 피해자에게 특정 행동(예: 주식 매수/매도)을 유도하는 데 실질적인 이점을 제공합니다. 또한, 제안된 공격이 표준 방어 메커니즘(판별기)을 우회할 수 있다는 점과, 모델 배포 후 추론 단계에서 악성코드를 통해 공격이 주입될 수 있다는 점을 보여줌으로써, ML 시스템의 전체 보안 파이프라인을 확보하는 것의 중요성을 강조합니다.</p>
<h3 id="3-what-is-the-literature-gap-기존-연구의-한계점">3) What is the literature gap? (기존 연구의 한계점)<a hidden class="anchor" aria-hidden="true" href="#3-what-is-the-literature-gap-기존-연구의-한계점">#</a></h3>
<p>적대적 공격 연구는 이미지 도메인에 집중되어 있으며, 시계열 데이터, 특히 금융 예측 데이터에 대한 연구는 초기 단계에 머물러 있었습니다. 기존 시계열 공격의 주요 한계점은 다음과 같습니다. 첫째, 시계열 데이터에 가해지는 섭동(Perturbation)은 이미지에 비해 눈에 띄기 쉬워 현실성(Believability)을 확보하기 어려웠습니다. 둘째, 기존의 표적 공격은 예측의 전반적인 추세를 변경하지 못하고 단순히 예측값을 위아래로 이동시키는 데 그쳤습니다. 셋째, 기존 공격 연구는 비교적 단순한 모델 아키텍처(예: 얕은 CNN)를 대상으로 했습니다.</p>
<h3 id="4-how-is-the-gap-filled-해결-방안">4) How is the gap filled? (해결 방안)<a hidden class="anchor" aria-hidden="true" href="#4-how-is-the-gap-filled-해결-방안">#</a></h3>
<p>본 연구는 원하는 기울기(추세)를 손실 함수 내부에 직접 내장하는 GSA와 LSSA를 개발하여 예측의 시간적 특성을 효과적으로 변경합니다. GSA는 예측의 끝점만을 사용하여 기울기를 계산함으로써 공격의 은밀성을 높였고, LSSA는 최소 제곱 선형 회귀(Least-Squares Linear Regression)의 기울기를 사용하여 예측의 전반적인 추세를 조작합니다. 또한, 이 기울기 기반 목표를 Conditional WGAN에 통합한 A-GAN을 사용하여, 현실적이고 탐지하기 어려운 합성 적대적 데이터를 대량으로 생성함으로써 현실성 문제를 해결했습니다. 마지막으로, N-HiTS와 같은 최신 모델을 표적으로 삼아 공격의 적용 가능성을 높였습니다.</p>
<h3 id="5-what-is-achieved-with-the-new-method-달성한-성과">5) What is achieved with the new method? (달성한 성과)<a hidden class="anchor" aria-hidden="true" href="#5-what-is-achieved-with-the-new-method-달성한-성과">#</a></h3>
<p><strong>[Table 1 분석: 평균 공격 지표 (Average Metrics)]</strong></p>
<p>$\epsilon = 2%$ (중앙값 주가의 2% 섭동) 조건에서, 제안된 기울기 기반 공격은 기존 공격 대비 목표 달성 측면에서 우수했습니다.</p>
<table>
<thead>
<tr>
<th style="text-align:left">Attack</th>
<th style="text-align:left">MAE</th>
<th style="text-align:left">RMSE</th>
<th style="text-align:left">Gen. Slope (Normal: $3.37 \times 10^{-2}$)</th>
<th style="text-align:left">LS Slope (Normal: $2.22 \times 10^{-2}$)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Normal</td>
<td style="text-align:left">2.15</td>
<td style="text-align:left">2.72</td>
<td style="text-align:left">$3.37 \times 10^{-2}$</td>
<td style="text-align:left">$2.22 \times 10^{-2}$</td>
</tr>
<tr>
<td style="text-align:left">BIM</td>
<td style="text-align:left"><strong>3.38</strong></td>
<td style="text-align:left"><strong>3.99</strong></td>
<td style="text-align:left">$3.48 \times 10^{-2}$</td>
<td style="text-align:left">$2.39 \times 10^{-2}$</td>
</tr>
<tr>
<td style="text-align:left">GSA (Up)</td>
<td style="text-align:left">2.26</td>
<td style="text-align:left">2.88</td>
<td style="text-align:left"><strong>$6.76 \times 10^{-2}$</strong></td>
<td style="text-align:left">$2.77 \times 10^{-2}$</td>
</tr>
<tr>
<td style="text-align:left">GSA (Down)</td>
<td style="text-align:left">2.23</td>
<td style="text-align:left">2.83</td>
<td style="text-align:left"><strong>$-1.68 \times 10^{-4}$</strong></td>
<td style="text-align:left">$1.75 \times 10^{-2}$</td>
</tr>
<tr>
<td style="text-align:left">LSSA (Up)</td>
<td style="text-align:left">2.49</td>
<td style="text-align:left">3.10</td>
<td style="text-align:left">$5.38 \times 10^{-2}$</td>
<td style="text-align:left"><strong>$4.96 \times 10^{-2}$</strong></td>
</tr>
<tr>
<td style="text-align:left">LSSA (Down)</td>
<td style="text-align:left">2.71</td>
<td style="text-align:left">3.33</td>
<td style="text-align:left">$1.56 \times 10^{-2}$</td>
<td style="text-align:left"><strong>$-5.04 \times 10^{-3}$</strong></td>
</tr>
</tbody>
</table>
<ul>
<li><strong>기울기 조작 성공:</strong> GSA (Up)는 일반 기울기(Gen. Slope)를 $6.76 \times 10^{-2}$로, 정상 예측($3.37 \times 10^{-2}$)의 약 두 배로 증가시켰습니다. LSSA (Up)는 최소 제곱 기울기(LS Slope)를 $4.96 \times 10^{-2}$로, 정상 예측($2.22 \times 10^{-2}$)의 두 배 이상으로 증가시켰습니다.</li>
<li><strong>하향 조작 성공:</strong> GSA (Down)는 일반 기울기를 거의 0에 가깝게($-1.68 \times 10^{-4}$) 만들었고, LSSA (Down)는 LS 기울기를 음수($-5.04 \times 10^{-3}$)로 만들어 하향 추세를 성공적으로 조작했습니다.</li>
<li><strong>은밀성 입증 (Figure 6):</strong> 4계층 CNN 판별기는 GSA 공격에 대해 52.08%의 정확도와 27.78%의 특이도를, LSSA 공격에 대해 56.25%의 정확도와 26.40%의 특이도를 보였습니다. 이는 공격이 표준 방어 메커니즘을 효과적으로 우회함을 의미합니다.</li>
<li><strong>A-GAN의 현실성 (Table 3):</strong> A-GAN은 실제 데이터의 LS Slope ($-2.41 \times 10^{-3}$)를 목표값인 $2.17 \times 10^{-1}$로 성공적으로 이동시키면서도, 통계적 지표(Table 4의 MMD: $1.20 \times 10^{-4}$)는 매우 낮아 합성 데이터가 실제 데이터와 충실하게 유사함을 입증했습니다.</li>
</ul>
<h3 id="6-what-data-are-used-사용-데이터셋">6) What data are used? (사용 데이터셋)<a hidden class="anchor" aria-hidden="true" href="#6-what-data-are-used-사용-데이터셋">#</a></h3>
<ul>
<li><strong>데이터셋:</strong> CRSP(Center for Research Security Prices)에서 수집된 모든 S&amp;P 500 주식의 일일 조정 가격(adjprc).</li>
<li><strong>기간:</strong> 2015년 5월 1일 ~ 2025년 5월 1일.</li>
<li><strong>특징:</strong> 금융 시계열 데이터로, 높은 변동성과 노이즈에 민감한 도메인 특성을 가집니다.</li>
<li><strong>전처리 및 특징 공학:</strong>
<ul>
<li>롤링 평균 및 표준 편차 (윈도우 크기 5, 10, 20).</li>
<li>로그 수익률 (Log Returns).</li>
<li>변화율 (Rate of Change, $\Delta=5$).</li>
<li>지수 이동 평균 (Exponential Moving Averages, 윈도우 크기 5, 10, 20).</li>
<li>요일 (범주형 특징).</li>
</ul>
</li>
<li><strong>데이터 분할:</strong> 600일 미만 기록은 제외되었으며, 훈련 75% (360개 기록), 검증 10% (48개), 테스트 15% (72개)로 계층적 분할(Stratified Split)을 사용했습니다.</li>
</ul>
<h3 id="7-what-are-the-limitations-저자가-언급한-한계점">7) What are the limitations? (저자가 언급한 한계점)<a hidden class="anchor" aria-hidden="true" href="#7-what-are-the-limitations-저자가-언급한-한계점">#</a></h3>
<ul>
<li><strong>일반성 부족:</strong> 공격 방법론의 일반적인 효과를 입증하기 위해 CNN이나 LSTM과 같은 다른 ML 모델을 피해 모델로 사용한 추가 연구가 필요합니다.</li>
<li><strong>방어 전략 부재:</strong> N-HiTS 모델의 구조적 제약(adjprc를 특징으로 사용하고 롤링 윈도우로 예측) 때문에 표준 방어 전략인 적대적 훈련(Adversarial Training)을 수행하는 것이 비실용적이었습니다.</li>
<li><strong>A-GAN의 불안정성:</strong> A-GAN은 <strong>모드 붕괴(Mode Collapse)</strong> 현상을 겪어 생성된 데이터의 다양성이 제한적이며, 이로 인해 합성 데이터가 판별기에 의해 쉽게 식별될 수 있습니다 (반면, 반복 공격 자체는 은밀함). A-GAN의 훈련 안정성과 성능 개선이 필요합니다.</li>
<li><strong>도메인 확장 필요:</strong> 기울기 기반 공격의 적용 가능성을 입증하기 위해 교통량이나 전력 사용량과 같은 다른 시계열 도메인에 대한 구현이 필요합니다.</li>
</ul>
<hr>
<h2 id="3-아키텍처-및-방법론-architecture--methodology">3. 아키텍처 및 방법론 (Architecture &amp; Methodology)<a hidden class="anchor" aria-hidden="true" href="#3-아키텍처-및-방법론-architecture--methodology">#</a></h2>
<h3 id="figure-분석-targeted-adversarial-gan-a-gan-아키텍처-figure-1">Figure 분석: Targeted Adversarial GAN (A-GAN) 아키텍처 (Figure 1)<a hidden class="anchor" aria-hidden="true" href="#figure-분석-targeted-adversarial-gan-a-gan-아키텍처-figure-1">#</a></h3>
<p>Figure 1은 제안된 표적형 적대적 GAN (A-GAN)의 고수준 아키텍처 다이어그램입니다. 이 구조는 기존의 GAN에 피해 모델인 N-HiTS를 두 번째 판별자(Critic)로 추가하여 표적 공격 목표를 통합한 형태입니다.</p>
<ol>
<li>
<p><strong>Generator (생성자):</strong></p>
<ul>
<li><strong>입력:</strong> Time Series Data (조건), Target Direction (목표 기울기 방향), Noise (잡음).</li>
<li><strong>역할:</strong> 실제 데이터와 유사하면서도 N-HiTS 모델을 속일 수 있는 합성 적대적 시계열 데이터($\tilde{\mathbf{x}}$)를 생성합니다.</li>
<li><strong>구조:</strong> 4계층 TCN (Temporal Convolutional Network)을 사용하여 장기 의존성(Long Term Dependencies)을 포착합니다.</li>
</ul>
</li>
<li>
<p><strong>Discriminator/Critic (판별자/비평가):</strong></p>
<ul>
<li><strong>입력:</strong> 실제 시계열 데이터($\mathbf{x}$) 또는 생성된 적대적 시계열 데이터($\tilde{\mathbf{x}}$).</li>
<li><strong>역할:</strong> 입력이 &ldquo;Real or Fake?&ldquo;인지 판별하여 생성자가 현실적인 데이터를 만들도록 유도합니다.</li>
<li><strong>구조:</strong> TCN 블록 3개와 GRU 블록 2개가 교대로 구성된 하이브리드 아키텍처를 사용합니다.</li>
</ul>
</li>
<li>
<p><strong>N-HiTS Model (피해 모델/두 번째 Critic):</strong></p>
<ul>
<li><strong>입력:</strong> 생성자가 만든 적대적 시계열 데이터($\tilde{\mathbf{x}}$).</li>
<li><strong>역할:</strong> 예측을 수행하고, 이 예측의 기울기가 목표 방향(&ldquo;Correct Slope?&quot;)과 일치하는지 확인하는 손실($\text{LSSA}(N\text{-HiTS}(\tilde{\mathbf{x}}))$)을 계산합니다. 이 손실은 생성자의 목적 함수에 통합되어 기울기 조작을 유도합니다.</li>
</ul>
</li>
</ol>
<p><strong>흐름:</strong> 생성자는 판별자를 속여 현실성을 확보하는 동시에, N-HiTS 모델을 속여 예측의 기울기를 원하는 방향으로 조작하는 이중 목표를 달성하도록 훈련됩니다.</p>
<h3 id="수식-상세">수식 상세<a hidden class="anchor" aria-hidden="true" href="#수식-상세">#</a></h3>
<h4 id="1-기울기-계산-수식">1. 기울기 계산 수식<a hidden class="anchor" aria-hidden="true" href="#1-기울기-계산-수식">#</a></h4>
<p><strong>General Slope Attack (GSA) 기울기 ($m$):</strong>
예측의 끝점 $(x_1, y_1)$과 $(x_2, y_2)$ 사이의 이산적인 기울기입니다.
$$m = \frac{y_2 - y_1}{x_2 - x_1}$$</p>
<p><strong>Least-Squares Slope Attack (LSSA) 기울기 ($m$):</strong>
최소 제곱 선형 회귀의 폐쇄형 해(Closed-form Solution)에서 가중치 항(기울기)을 사용합니다. $N$은 예측 길이, $\bar{x}$와 $\bar{y}$는 각각 $x$와 $y$의 평균입니다.
$$m = \frac{\sum_{i=0}^{N} (x_i - \bar{x})(y_i - \bar{y})}{\sum_{i=0}^{N} (x_i - \bar{x})^2}$$</p>
<h4 id="2-기울기-공격-손실-함수-loss-function">2. 기울기 공격 손실 함수 (Loss Function)<a hidden class="anchor" aria-hidden="true" href="#2-기울기-공격-손실-함수-loss-function">#</a></h4>
<p>GSA와 LSSA 모두 동일한 손실 함수 구조를 사용하며, $m$은 위에서 계산된 기울기입니다. $t \in {-1, 0, 1}$은 목표 방향입니다.
$$\text{loss} = \begin{cases} c e^{-tdm} &amp; \text{if } t \in {-1, 1} \ c m^2 &amp; \text{if } t = 0 \end{cases} \quad (1)$$</p>
<ul>
<li>$t=1$ (상승 목표): $m$이 작거나 음수일 때 손실이 커집니다.</li>
<li>$t=-1$ (하락 목표): $m$이 크거나 양수일 때 손실이 커집니다.</li>
<li>$t=0$ (제로 기울기 목표): 기울기 $m$의 제곱에 비례하여 손실이 커집니다.</li>
</ul>
<h4 id="3-adversarial-gan-a-gan-손실-함수">3. Adversarial GAN (A-GAN) 손실 함수<a hidden class="anchor" aria-hidden="true" href="#3-adversarial-gan-a-gan-손실-함수">#</a></h4>
<p>본 연구는 Conditional Wasserstein GAN (C-WGAN)에 Gradient Penalty (GP)를 추가한 구조를 사용합니다.</p>
<p><strong>A-GAN Generator Loss ($L_g$):</strong>
생성자는 판별자를 속이는 목표와 N-HiTS 모델을 속이는 목표를 동시에 가집니다.
$$L_g = \mathbb{E}<em>{\mathbf{x} \sim p</em>{\mathbf{x}}} [D(\mathbf{x})] + \alpha \cdot \text{LSSA}(N\text{-HiTS}(\mathbf{x}))$$</p>
<ul>
<li>$\mathbb{E}<em>{\mathbf{x} \sim p</em>{\mathbf{x}}} [D(\mathbf{x})]$: 판별자가 생성된 데이터를 실제라고 판단하도록 유도하는 항 (WGAN Critic Loss).</li>
<li>$\alpha$: 적대적 손실의 균형을 맞추는 스케일링 인자.</li>
<li>$\text{LSSA}(N\text{-HiTS}(\mathbf{x}))$: N-HiTS 예측에 대한 LSSA 손실 (기울기 조작 목표).</li>
</ul>
<p><strong>A-GAN Final Loss ($L$):</strong>
WGAN-GP 형태의 최종 손실 함수입니다. $\tilde{\mathbf{x}}$는 합성 샘플, $\hat{\mathbf{x}}$는 실제와 합성 샘플 사이의 보간된 샘플입니다.
$$L = L_g - \mathbb{E}<em>{\tilde{\mathbf{x}} \sim p_g} [D(\tilde{\mathbf{x}})] + \lambda \cdot \mathbb{E}</em>{\hat{\mathbf{x}} \sim p_{\hat{\mathbf{x}}}} [(|\nabla_{\hat{\mathbf{x}}} D(\hat{\mathbf{x}})| - 1)^2]$$</p>
<ul>
<li>$\lambda$: 기울기 페널티의 크기를 제어하는 상수.</li>
</ul>
<h3 id="vanilla-u-net-비교-n-hits-아키텍처-분석">Vanilla U-Net 비교 (N-HiTS 아키텍처 분석)<a hidden class="anchor" aria-hidden="true" href="#vanilla-u-net-비교-n-hits-아키텍처-분석">#</a></h3>
<p>본 논문은 U-Net이 아닌 <strong>N-HiTS</strong> 모델을 피해 모델로 사용합니다. N-HiTS는 N-BEATS 아키텍처를 기반으로 구축되었으며, 계산 성능과 정확도를 동시에 개선하기 위해 다음과 같은 핵심 모듈을 추가/수정했습니다.</p>
<table>
<thead>
<tr>
<th style="text-align:left">구분</th>
<th style="text-align:left">Vanilla N-BEATS</th>
<th style="text-align:left">N-HiTS (Neural Hierarchical Interpolation for Time Series)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>기본 구조</strong></td>
<td style="text-align:left">MLP(Multi-layer Perceptron)를 사용하여 Backcast 및 Forecast 계수 추정.</td>
<td style="text-align:left">MLP를 사용하여 Backcast 및 Forecast 계수 추정.</td>
</tr>
<tr>
<td style="text-align:left"><strong>핵심 추가 모듈</strong></td>
<td style="text-align:left">없음</td>
<td style="text-align:left"><strong>MaxPool 레이어 추가:</strong> 각 블록 $b$에 커널 크기 $k_t$를 가진 MaxPool을 도입.</td>
</tr>
<tr>
<td style="text-align:left"><strong>목적</strong></td>
<td style="text-align:left">시계열의 장기/단기 콘텐츠를 분리하여 예측.</td>
<td style="text-align:left">MaxPool을 통해 MLP가 시계열의 저주파 및 대규모 콘텐츠에 집중하도록 유도하여 <strong>서로 다른 속도로 시계열을 샘플링</strong>할 수 있게 함.</td>
</tr>
<tr>
<td style="text-align:left"><strong>최종 예측</strong></td>
<td style="text-align:left">모든 블록의 Forecast를 합산.</td>
<td style="text-align:left"><strong>계층적 보간(Hierarchical Interpolation)</strong> 수행. 각 예측 스택에 표현력 비율(Expressiveness Ratio)을 할당하고, 이 비율의 크기에 따라 예측 스택을 합산하여 최종 예측을 생성.</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="4-태그-제안-tags-suggestion">4. 태그 제안 (Tags Suggestion)<a hidden class="anchor" aria-hidden="true" href="#4-태그-제안-tags-suggestion">#</a></h2>
<ol>
<li>Adversarial Attacks (적대적 공격)</li>
<li>Financial Time-Series (금융 시계열)</li>
<li>N-HiTS</li>
<li>Targeted Manipulation (표적 조작)</li>
<li>ML Security Pipeline (ML 보안 파이프라인)</li>
</ol>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://hanwo-ol.github.io/Unet_master/tags/adversarial-attacks-%EC%A0%81%EB%8C%80%EC%A0%81-%EA%B3%B5%EA%B2%A9/">Adversarial Attacks (적대적 공격)</a></li>
      <li><a href="https://hanwo-ol.github.io/Unet_master/tags/financial-time-series-%EA%B8%88%EC%9C%B5-%EC%8B%9C%EA%B3%84%EC%97%B4/">Financial Time-Series (금융 시계열)</a></li>
      <li><a href="https://hanwo-ol.github.io/Unet_master/tags/n-hits/">N-HiTS</a></li>
      <li><a href="https://hanwo-ol.github.io/Unet_master/tags/targeted-manipulation-%ED%91%9C%EC%A0%81-%EC%A1%B0%EC%9E%91/">Targeted Manipulation (표적 조작)</a></li>
      <li><a href="https://hanwo-ol.github.io/Unet_master/tags/ml-security-pipeline-ml-%EB%B3%B4%EC%95%88-%ED%8C%8C%EC%9D%B4%ED%94%84%EB%9D%BC%EC%9D%B8/">ML Security Pipeline (ML 보안 파이프라인)</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://hanwo-ol.github.io/Unet_master/posts/satellite-to-street-disaster-impact-estimator/">
    <span class="title">« Prev</span>
    <br>
    <span>Satellite to Street : Disaster Impact Estimator</span>
  </a>
  <a class="next" href="https://hanwo-ol.github.io/Unet_master/posts/neural-networks-for-tamed-milstein-approximation-of-sdes-with-additive-symmetric-jump-noise-driven-by-a-poisson-random-measure/">
    <span class="title">Next »</span>
    <br>
    <span>Neural Networks for Tamed Milstein Approximation of SDEs with Additive Symmetric Jump Noise Driven by a Poisson Random Measure</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share Targeted Manipulation: Slope-Based Attacks on Financial Time-Series Data on twitter"
        href="https://twitter.com/intent/tweet/?text=Targeted%20Manipulation%3a%20Slope-Based%20Attacks%20on%20Financial%20Time-Series%20Data&amp;url=https%3a%2f%2fhanwo-ol.github.io%2fUnet_master%2fposts%2ftargeted-manipulation-slope-based-attacks-on-financial-time-series-data%2f&amp;hashtags=AdversarialAttacks%28%ec%a0%81%eb%8c%80%ec%a0%81%ea%b3%b5%ea%b2%a9%29%2cFinancialTime-Series%28%ea%b8%88%ec%9c%b5%ec%8b%9c%ea%b3%84%ec%97%b4%29%2cN-HiTS%2cTargetedManipulation%28%ed%91%9c%ec%a0%81%ec%a1%b0%ec%9e%91%29%2cMLSecurityPipeline%28ML%eb%b3%b4%ec%95%88%ed%8c%8c%ec%9d%b4%ed%94%84%eb%9d%bc%ec%9d%b8%29">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Targeted Manipulation: Slope-Based Attacks on Financial Time-Series Data on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fhanwo-ol.github.io%2fUnet_master%2fposts%2ftargeted-manipulation-slope-based-attacks-on-financial-time-series-data%2f&amp;title=Targeted%20Manipulation%3a%20Slope-Based%20Attacks%20on%20Financial%20Time-Series%20Data&amp;summary=Targeted%20Manipulation%3a%20Slope-Based%20Attacks%20on%20Financial%20Time-Series%20Data&amp;source=https%3a%2f%2fhanwo-ol.github.io%2fUnet_master%2fposts%2ftargeted-manipulation-slope-based-attacks-on-financial-time-series-data%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Targeted Manipulation: Slope-Based Attacks on Financial Time-Series Data on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2fhanwo-ol.github.io%2fUnet_master%2fposts%2ftargeted-manipulation-slope-based-attacks-on-financial-time-series-data%2f&title=Targeted%20Manipulation%3a%20Slope-Based%20Attacks%20on%20Financial%20Time-Series%20Data">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Targeted Manipulation: Slope-Based Attacks on Financial Time-Series Data on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fhanwo-ol.github.io%2fUnet_master%2fposts%2ftargeted-manipulation-slope-based-attacks-on-financial-time-series-data%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Targeted Manipulation: Slope-Based Attacks on Financial Time-Series Data on whatsapp"
        href="https://api.whatsapp.com/send?text=Targeted%20Manipulation%3a%20Slope-Based%20Attacks%20on%20Financial%20Time-Series%20Data%20-%20https%3a%2f%2fhanwo-ol.github.io%2fUnet_master%2fposts%2ftargeted-manipulation-slope-based-attacks-on-financial-time-series-data%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Targeted Manipulation: Slope-Based Attacks on Financial Time-Series Data on telegram"
        href="https://telegram.me/share/url?text=Targeted%20Manipulation%3a%20Slope-Based%20Attacks%20on%20Financial%20Time-Series%20Data&amp;url=https%3a%2f%2fhanwo-ol.github.io%2fUnet_master%2fposts%2ftargeted-manipulation-slope-based-attacks-on-financial-time-series-data%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2025 <a href="https://hanwo-ol.github.io/Unet_master/">Research Agent Knowledge Base</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
